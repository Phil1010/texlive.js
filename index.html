<!doctype html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <style>
    #container {
      display: flex;
      height: 100vh;
    }

    #code-container {
      flex: 1;
      padding: 10px;
      border-right: 1px solid #ccc;
    }

    #pdf-container {
      flex: 1;
      padding: 10px;
    }

    textarea {
      width: 100%;
      height: 100%;
    }

    iframe {
      width: 100%;
      height: 100%;
    }
  </style>

  <script src="promisejs/promise.js"></script>
  <script src="pdftex.js"></script>
</head>

<body>
  <div id="container">
    <div id="code-container">
      <textarea rows="10" id="input">\documentclass{article}
\begin{document}
Hello, LaTeX!
\end{document}</textarea>
      <br />
      <button id="compile">Compile this LaTeX code to a PDF</button>
    </div>
    <div id="pdf-container">
      <iframe id="pdf-iframe"></iframe>
    </div>
  </div>

  <script>
    var packages = [
      'amsfonts',
      'amsmath',
      'amssymb',
      'amsthm',
      'inputenc',
      'fontenc',
      'babel-french',
      'fancybox',
      'graphics',
      'tikz',
      'geometry'
    ];

    Promise.all(packages.map(texlive.installPackage))
      .then(function () {
        console.log('1111 Packages installed successfully');
      })
      .catch(function (error) {
        console.error('2222 Error installing packages', error);
      });



    var compile = function (source_code) {
      var pdftex = new PDFTeX();
      return pdftex.compile(source_code);
    }

    document.getElementById("compile").addEventListener("click", function (e) {
      var source_code = document.getElementById("input").value;
      compile(source_code).then(function (pdf) {
        // PDF compilation completed
        // Use 'pdf' variable as desired
        console.log(pdf);
        // Example: Display PDF in iframe
        var iframe = document.getElementById("pdf-iframe");
        iframe.src = pdf;
      });
    });
  </script>
</body>

</html>